<!DOCTYPE html>
<html lang="en">

<head>
    <title>PGPkeygenerator.com - Open Source, free, online and secure PGP key generator</title>
    <meta charset="UTF-8">
    <meta name="author" content="Athanasios Emmanouilidis">
    <meta name="keywords"
        content="PGP, key generator, cryptography, encryption, privacy, public key, private key, PGP encryption, GPG, secure communication, digital signature, email encryption, PGP key management, cryptographic keys, asymmetric encryption, public key infrastructure, data protection, secure messaging, cryptographic security, key pair generation, key storage, security tools, cryptographic software, encryption tools">
    <meta name="robots" content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#272727">
    <meta name="apple-mobile-web-app-status-bar-style" content="#272727">
    <meta name="description"
        content="Generate secure PGP keys for free online with PGPkeygenerator.com. Safeguard your communications with a trusted Open Source PGP key generator tool.">

    <!-- Content Security Policy to restrict resources and ensure client-side only execution -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src 'self' data:; font-src 'self'; connect-src 'self' https://cdn.jsdelivr.net;">

    <!-- Open Graph Meta Tags for social media sharing -->
    <meta property="og:title" content="PGPkeygenerator.com - Generate OpenPGP keys online securely">
    <meta property="og:description" content="Generate OpenPGP keys online securely.">
    <meta property="og:url" content="https://pgpkeygenerator.com">
    <meta property="og:type" content="website">

    <!-- Twitter Card Meta Tags for Twitter sharing -->
    <meta name="twitter:title" content="PGPkeygenerator.com - Generate OpenPGP keys online securely">
    <meta name="twitter:description" content="Generate OpenPGP keys online securely.">

    <link rel="stylesheet" href="style.css">

    <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "WebSite",
            "name": "PGPkeygenerator.com",
            "url": "https://www.pgpkeygenerator.com/",
            "description": "Generate OpenPGP keys online securely."
        }
    </script>

</head>

<body>

    <div class="security-banner"
        style="background: #eefbff; border: 1px solid #007bff; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; align-items: center;">
        <span style="font-size: 24px; margin-right: 15px;">üõ°Ô∏è</span>
        <div>
            <strong>Air-Gap Ready:</strong> This tool is 100% client-side. Once the page is loaded, you can
            <strong>disconnect your internet</strong> to generate your keys in a completely isolated environment.
            <a href="faq.html" style="color: #007bff; text-decoration: underline; margin-left: 5px;">Learn more</a>
        </div>
    </div>

    <div id="title-and-parameters-holder">

        <div id="title-holder">
            <h1 class="title" style="margin-bottom:0px;">üîë PGPkeygenerator.com</h1>
            <p>PGPkeygenerator.com is an Open Source, free, online and secure PGP key
                generator.</p>
            <ul>
                <li><a href="https://github.com/athanasiosem/pgpkeygenerator.com" target="_blank" rel="noopener noreferrer">Open Source project</a>. The <a
                        href="https://openpgpjs.org/" target="_blank" rel="noopener noreferrer">OpenPGP.js</a> library is used.</li>
                <li>All code runs on the client-side. No servers involved.</li>
                <li>No user tracking. Feel free to unplug the Internet before use.</li>
            </ul>
            <p style="margin-bottom:0px;"><a href="faq.html">Read the FAQ</a> for more information or <a
                    href="about-pgp-encryption.html">learn about PGP encryption.</a></p>
        </div>

        <div id="parameters-holder">

            <div id="textinput-holder">
                <div>
                    <label for="options-type">Key Algorithm</label>
                    <select name="options-type" onchange="keyAlgorithmChanged(this)" id="options-type">
                        <option value="ecc">ECC</option>
                        <option value="rsa">RSA</option>
                    </select>
                </div>

                <div id="key-size-select-holder" class="key-size-select-holder">
                    <label for="options-key-size">Key Size</label>
                    <select name="options-key-size" id="options-key-size">
                        <option value="4096">4096 bits</option>
                        <option value="2048">2048 bits</option>
                    </select>
                </div>

                <div>
                    <label for="options-name">Name</label>
                    <input type="text" id="options-name">
                </div>

                <div>
                    <label for="options-email">Email</label>
                    <input type="email" id="options-email">
                </div>

                <div>
                    <label for="options-passphrase">Passphrase</label>
                    <input type="password" id="options-passphrase">
                </div>

                <div>
                    <label for="options-expiration">Expiration Time</label>
                    <select name="options-expiration" id="options-expiration">
                        <option value="0">Never Expires</option>
                        <option value="31536000">1 Year</option>
                        <option value="63072000">2 Years</option>
                        <option value="126144000">4 Years</option>
                        <option value="252288000">8 Years</option>
                    </select>
                </div>

            </div>

            <div id="generate-key-button-holder">
                <button type="button" id="generate-keys-button" onclick="generateKeys()">Generate Keys</button>
            </div>
        </div>

    </div>

    <div id="keys-holder-parent">

        <div id="keys-holder">
            <div>
                <h2>
                    <label for="private-key-textarea">
                        Private Key
                    </label>
                </h2>
                <div class="button-holder">
                    <button id="copy-private-key-button" type="button" data-target="private-key-textarea"
                        onclick="copyToClipboard(this)" disabled>Copy</button>
                    <button id="download-private-key-button" type="button" data-target="private-key-textarea"
                        onclick="downloadFile(this)" disabled>Download File</button>
                </div>
                <textarea id="private-key-textarea" name="private-key-textarea" rows="10" cols="40" disabled
                    readonly></textarea>
            </div>

            <div>
                <h2>
                    <label for="public-key-textarea">
                        Public Key
                    </label>
                </h2>
                <div class="button-holder">
                    <button id="copy-public-key-button" type="button" data-target="public-key-textarea"
                        onclick="copyToClipboard(this)" disabled>Copy</button>
                    <button id="download-public-key-button" type="button" data-target="public-key-textarea"
                        onclick="downloadFile(this)" disabled>Download File</button>
                </div>
                <textarea id="public-key-textarea" name="public-key-textarea" rows="10" cols="40" disabled
                    readonly></textarea>
            </div>

            <div>
                <h2>
                    <label for="revocation-certificate-textarea">
                        Revocation Certificate
                    </label>
                </h2>
                <div class="button-holder">
                    <button id="copy-revocation-certificate-button" type="button"
                        data-target="revocation-certificate-textarea" onclick="copyToClipboard(this)" disabled>Copy</button>
                    <button id="download-revocation-certificate-button" type="button"
                        data-target="revocation-certificate-textarea" onclick="downloadFile(this)" disabled>Download
                        File</button>
                </div>
                <textarea id="revocation-certificate-textarea" name="revocation-certificate-textarea" rows="10"
                    cols="40" disabled readonly></textarea>
            </div>
        </div>

    </div>

    <div id="copyright-holder">Copyright 2025 - <a href="https://emman.dev" target="_blank" rel="noopener noreferrer">Athanasios Emmanouilidis</a></div>


    <script>

        const privateKeyTextarea = document.querySelector("#private-key-textarea");
        const publicKeyTextarea = document.querySelector("#public-key-textarea");
        const revocationCertificateTextarea = document.querySelector("#revocation-certificate-textarea");

        const buttonGenerateKeys = document.querySelector("#generate-keys-button");
        const optionsType = document.querySelector("#options-type");
        const keySizeSelectHolder = document.querySelector("#key-size-select-holder");
        const optionsKeySize = document.querySelector("#options-key-size");
        const optionsName = document.querySelector("#options-name");
        const optionsEmail = document.querySelector("#options-email");
        const optionsPassphrase = document.querySelector("#options-passphrase");
        const optionsExpirationTime = document.querySelector("#options-expiration");

        const copyPrivateKeyButton = document.querySelector("#copy-private-key-button");
        const copyPublicKeyButton = document.querySelector("#copy-public-key-button");
        const copyRevocationCertificateButton = document.querySelector("#copy-revocation-certificate-button");

        const downloadPrivateKeyButton = document.querySelector("#download-private-key-button");
        const downloadPublicKeyButton = document.querySelector("#download-public-key-button");
        const downloadRevocationCertificateButton = document.querySelector("#download-revocation-certificate-button");

        const downloadFile = (element) => {

            const textareaName = element.dataset.target;

            const link = document.createElement("a");
            const content = document.querySelector("#" + textareaName).value;
            const file = new Blob([content], { type: 'text/plain' });
            link.href = URL.createObjectURL(file);
            link.download = textareaName.replace("-textarea", "") + ".asc";
            link.click();
            URL.revokeObjectURL(link.href);
        };

        const copyToClipboard = (element) => {

            const textareaName = element.dataset.target;

            const textarea = document.querySelector("#" + textareaName);
            
            navigator.clipboard.writeText(textarea.value).then(() => {
                const originalText = element.innerText;
                element.innerText = "Copied!";
                setTimeout(() => {
                    element.innerText = originalText;
                }, 2000);
            }).catch(err => {
                console.error("Failed to copy: ", err);
            });
        }

        const keyAlgorithmChanged = (element) => {

            if (element.value == "rsa") {
                keySizeSelectHolder.classList.remove("key-size-select-holder");
            } else {
                keySizeSelectHolder.classList.add("key-size-select-holder");
            }
        };

        const worker = new Worker("worker.js");

        worker.onerror = (error) => {
            console.error("Worker error:", error);
            alert("An error occurred with the background worker. Please reload the page.");
            buttonGenerateKeys.disabled = false;
            buttonGenerateKeys.innerText = "Generate Keys";
        };

        worker.onmessage = async function handleMessageFromMain(msg) {

            if (msg.data.error) {
                alert("Error generating keys: " + msg.data.error);
                buttonGenerateKeys.disabled = false;
                buttonGenerateKeys.innerText = "Generate Keys";
                return;
            }

            privateKeyTextarea.value = msg.data.privateKey;
            publicKeyTextarea.value = msg.data.publicKey;
            revocationCertificateTextarea.value = msg.data.revocationCertificate;

            copyPrivateKeyButton.classList.add("copy-button");
            copyPublicKeyButton.classList.add("copy-button");
            copyRevocationCertificateButton.classList.add("copy-button");

            downloadPrivateKeyButton.classList.add("download-button");
            downloadPublicKeyButton.classList.add("download-button");
            downloadRevocationCertificateButton.classList.add("download-button");

            buttonGenerateKeys.disabled = false;
            buttonGenerateKeys.innerText = "Generate Keys";

            copyPrivateKeyButton.disabled = false;
            copyPublicKeyButton.disabled = false;
            copyRevocationCertificateButton.disabled = false;

            downloadPrivateKeyButton.disabled = false;
            downloadPublicKeyButton.disabled = false;
            downloadRevocationCertificateButton.disabled = false;

            privateKeyTextarea.disabled = false;
            publicKeyTextarea.disabled = false;
            revocationCertificateTextarea.disabled = false;
        };

        const generateKeys = () => {

            const optionsTypeValue = optionsType.value;
            const optionsKeySizeValue = optionsKeySize.value;
            const optionsNameValue = optionsName.value.trim();
            const optionsEmailValue = optionsEmail.value.trim();
            const optionsPassphraseValue = optionsPassphrase.value;
            const optionsExpirationTimeValue = optionsExpirationTime.value;

            const optionsObject = {
                optionsTypeValue,
                optionsKeySizeValue, optionsNameValue,
                optionsEmailValue, optionsPassphraseValue,
                optionsExpirationTimeValue
            };

            if (!optionsEmail.checkValidity()) {
                alert('Please enter a valid email address.');
                return;
            }

            copyPrivateKeyButton.classList.remove("copy-button");
            copyPublicKeyButton.classList.remove("copy-button");
            copyRevocationCertificateButton.classList.remove("copy-button");

            downloadPrivateKeyButton.classList.remove("download-button");
            downloadPublicKeyButton.classList.remove("download-button");
            downloadRevocationCertificateButton.classList.remove("download-button");

            buttonGenerateKeys.disabled = true;
            buttonGenerateKeys.innerText = "Generating...";

            copyPrivateKeyButton.disabled = true;
            copyPublicKeyButton.disabled = true;
            copyRevocationCertificateButton.disabled = true;
            downloadPrivateKeyButton.disabled = true;
            downloadPublicKeyButton.disabled = true;
            downloadRevocationCertificateButton.disabled = true;

            worker.postMessage(optionsObject);

        };
    </script>
</body>

</html>